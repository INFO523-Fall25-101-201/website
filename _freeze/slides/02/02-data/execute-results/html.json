{
  "hash": "c14220706d38e5db336144f4aa5467ca",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Introduction to Data\nsubtitle: Data Mining and Discovery\ntitle-slide-attributes:\n  data-background-image: ../minedata-bg.png\n  data-background-size: 600px, cover\n  data-slide-number: none\nformat: revealjs\nauto-stretch: false\n---\n\n# Hello data\n\n## Setup\n\n::: {#d11aae27 .cell execution_count=1}\n``` {.python .cell-code}\n# Import libraries\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nfrom scipy.stats import chi2_contingency\n```\n:::\n\n\n## Case study: using stents to prevent strokes {.smaller}\n\n![](images/stents.jpeg){fig-align=\"center\" width=\"500\"}\n\n> **Does the use of stents reduce the risk of strokes?**\n\n::: aside\nSource: [Chimowitz MI, Lynn MJ, Derdeyn CP, et al. 2011.](https://www.nejm.org/doi/full/10.1056/NEJMoa1105335)\n:::\n\n## Read in and view data {.smaller}\n\n::: {#5382c0ab .cell execution_count=2}\n``` {.python .cell-code}\nstent30 = pd.read_csv(\"data/stent30.csv\")\nstent30.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>group</th>\n      <th>outcome</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>treatment</td>\n      <td>stroke</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>treatment</td>\n      <td>stroke</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>treatment</td>\n      <td>stroke</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>treatment</td>\n      <td>stroke</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>treatment</td>\n      <td>stroke</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: incremental\n-   **Treatment group (N = 224):** received stent and medical management (medications, management of risk factors, lifestyle modification)\n\n-   **Control group(N = 227):** same medical management as the treatment group, but no stent\n\n-   Status 30 days after enrollment\n:::\n\n## What are the hypothes[es]{.underline}?\n\n::: incremental\n1.  Stents alone prevent strokes\n\n2.  Medical management alone prevents strokes\n\n3.  Both stents and medical management prevent strokes\n:::\n\n::: fragment\n> Why [multiple hypotheses]{.underline}?\n:::\n\n## Table {.smaller}\n\n::: panel-tabset\n## Frequency\n\n::: {#43dfb60c .cell execution_count=3}\n``` {.python .cell-code}\n# Create a frequency table for the 'group' and 'outcome' columns\nfrequency_table = pd.crosstab(index = stent30['group'], columns = stent30['outcome'])\n\nfrequency_table\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>outcome</th>\n      <th>no event</th>\n      <th>stroke</th>\n    </tr>\n    <tr>\n      <th>group</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>control</th>\n      <td>214</td>\n      <td>13</td>\n    </tr>\n    <tr>\n      <th>treatment</th>\n      <td>191</td>\n      <td>33</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Proportion\n\n::: {#373d2b27 .cell execution_count=4}\n``` {.python .cell-code}\n# Convert frequency table to a proportional table\nproportional_table = frequency_table / frequency_table.sum().sum()\n\nproportional_table.round(2)\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>outcome</th>\n      <th>no event</th>\n      <th>stroke</th>\n    </tr>\n    <tr>\n      <th>group</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>control</th>\n      <td>0.47</td>\n      <td>0.03</td>\n    </tr>\n    <tr>\n      <th>treatment</th>\n      <td>0.42</td>\n      <td>0.07</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n:::\n\n::: fragment\nSo... does the control affect the occurrence of strokes after 30 days?\n:::\n\n## Chi-squared test\n\nWe need to test the relationship statistically:\n\n::: {#c2cf0cf3 .cell execution_count=5}\n``` {.python .cell-code code-line-numbers=\"1-9|2|4,5,6,7\"}\n# Performing the Chi-Squared Test\nchi2, p, dof, expected = chi2_contingency(frequency_table)\n\nprint(f\"Chi-squared statistic: {chi2.round(2)}\")\nprint(f\"P-value: {p.round(3)}\")\nprint(f\"Degrees of freedom: {dof}\")\nprint(f\"Expected frequencies:\\n{expected.round(2)}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nChi-squared statistic: 9.02\nP-value: 0.003\nDegrees of freedom: 1\nExpected frequencies:\n[[203.85  23.15]\n [201.15  22.85]]\n```\n:::\n:::\n\n\n## Conclusions\n\n::: incremental\n1.  There was a \\>2.5x increase in strokes from the treatment!\n\n2.  There is a statistical difference between no event and strokes when comparing control and treatment groups\n:::\n\n::: fragment\nBUT! We cannot generalize the results to all patience and all stents.\n:::\n\n# Data basics\n\n## Observations, variables, data matrices {.smaller}\n\n::: {#378f997d .cell execution_count=6}\n``` {.python .cell-code}\nloan50 = pd.read_csv(\"data/loan50.csv\")\nloan50.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>state</th>\n      <th>emp_length</th>\n      <th>term</th>\n      <th>homeownership</th>\n      <th>annual_income</th>\n      <th>verified_income</th>\n      <th>debt_to_income</th>\n      <th>total_credit_limit</th>\n      <th>total_credit_utilized</th>\n      <th>num_cc_carrying_balance</th>\n      <th>loan_purpose</th>\n      <th>loan_amount</th>\n      <th>grade</th>\n      <th>interest_rate</th>\n      <th>public_record_bankrupt</th>\n      <th>loan_status</th>\n      <th>has_second_income</th>\n      <th>total_income</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>NJ</td>\n      <td>3.0</td>\n      <td>60</td>\n      <td>rent</td>\n      <td>59000.0</td>\n      <td>Not Verified</td>\n      <td>0.557525</td>\n      <td>95131</td>\n      <td>32894</td>\n      <td>8</td>\n      <td>debt_consolidation</td>\n      <td>22000</td>\n      <td>B</td>\n      <td>10.90</td>\n      <td>0</td>\n      <td>Current</td>\n      <td>False</td>\n      <td>59000.0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>CA</td>\n      <td>10.0</td>\n      <td>36</td>\n      <td>rent</td>\n      <td>60000.0</td>\n      <td>Not Verified</td>\n      <td>1.305683</td>\n      <td>51929</td>\n      <td>78341</td>\n      <td>2</td>\n      <td>credit_card</td>\n      <td>6000</td>\n      <td>B</td>\n      <td>9.92</td>\n      <td>1</td>\n      <td>Current</td>\n      <td>False</td>\n      <td>60000.0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>SC</td>\n      <td>NaN</td>\n      <td>36</td>\n      <td>mortgage</td>\n      <td>75000.0</td>\n      <td>Verified</td>\n      <td>1.056280</td>\n      <td>301373</td>\n      <td>79221</td>\n      <td>14</td>\n      <td>debt_consolidation</td>\n      <td>25000</td>\n      <td>E</td>\n      <td>26.30</td>\n      <td>0</td>\n      <td>Current</td>\n      <td>False</td>\n      <td>75000.0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>CA</td>\n      <td>0.0</td>\n      <td>36</td>\n      <td>rent</td>\n      <td>75000.0</td>\n      <td>Not Verified</td>\n      <td>0.574347</td>\n      <td>59890</td>\n      <td>43076</td>\n      <td>10</td>\n      <td>credit_card</td>\n      <td>6000</td>\n      <td>B</td>\n      <td>9.92</td>\n      <td>0</td>\n      <td>Current</td>\n      <td>False</td>\n      <td>75000.0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>OH</td>\n      <td>4.0</td>\n      <td>60</td>\n      <td>mortgage</td>\n      <td>254000.0</td>\n      <td>Not Verified</td>\n      <td>0.238150</td>\n      <td>422619</td>\n      <td>60490</td>\n      <td>2</td>\n      <td>home_improvement</td>\n      <td>25000</td>\n      <td>B</td>\n      <td>9.43</td>\n      <td>0</td>\n      <td>Current</td>\n      <td>False</td>\n      <td>254000.0</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: incremental\n-   Each row is a **case**\n\n-   Each column is a **variable**\n\n-   The output is part of a **data frame**\n:::\n\n::: aside\nSource: [Lending Club](https://www.lendingclub.com/info/statistics.action)\n:::\n\n## Metadata {.smaller}\n\n| Variable | Description |\n|------------------|------------------------------------------------------|\n| `loan_amount` | Amount of the loan received, in US dollars. |\n| `interest_rate` | Interest rate on the loan, in an annual percentage. |\n| `term` | The length of the loan, which is always set as a whole number of months. |\n| `grade` | Loan grade, which takes a values A through G and represents the quality of the loan and its likelihood of being repaid. |\n| `state` | US state where the borrower resides. |\n| `total_income` | Borrower's total income, including any second income, in US dollars. |\n| `homeownership` | Indicates whether the person owns, owns but has a mortgage, or rents. |\n\n## Types of variables\n\n![](images/variables-1.png){fig-align=\"center\" width=\"3000\"}\n\n## Types of variables\n\n::: {#bd5f9b85 .cell execution_count=7}\n``` {.python .cell-code}\ncounty = pd.read_csv(\"data/county.csv\")\n\ncounty.dtypes\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```\nname                  object\nstate                 object\npop2000              float64\npop2010                int64\npop2017              float64\npop_change           float64\npoverty              float64\nhomeownership        float64\nmulti_unit           float64\nunemployment_rate    float64\nmetro                 object\nmedian_edu            object\nper_capita_income    float64\nmedian_hh_income     float64\nsmoking_ban           object\ndtype: object\n```\n:::\n:::\n\n\n::: aside\nSource: US Census via the [usdata R package](https://github.com/OpenIntroStat/usdata)\n:::\n\n## Relationships between variables {.smaller}\n\n::: panel-tabset\n## Plot\n\n::: {#cell-county-scatter-1 .cell execution_count=8}\n\n::: {.cell-output .cell-output-display}\n![](02-data_files/figure-revealjs/county-scatter-1-output-1.png){#county-scatter-1 width=620 height=390}\n:::\n:::\n\n\n## Code\n\n:::\n\n::: fragment\n`homeownership` (y) and `multi_unit` (x) have a hypothesized **association**\n:::\n\n## Associations {.smaller}\n\n::::::: columns\n:::: {.column width=\"50%\"}\n\n::: {#a80b2c9e .cell execution_count=9}\n\n::: {.cell-output .cell-output-display}\n![](02-data_files/figure-revealjs/cell-10-output-1.png){width=469 height=307}\n:::\n:::\n\n\n::: fragment\nAssociations can be **negative**...\n:::\n::::\n\n:::: {.column width=\"50%\"}\n\n::: {#a4748817 .cell execution_count=10}\n\n::: {.cell-output .cell-output-display}\n![](02-data_files/figure-revealjs/cell-11-output-1.png){width=449 height=307}\n:::\n:::\n\n\n::: fragment\n...or **positive**\n:::\n::::\n:::::::\n\n::: fragment\nTwo variables can also not be associated (**independent**)\n:::\n\n:::: fragment\n::: incremental\n-   *Median household income* is the explanatory variable\n\n-   *Population change* is the **response variable**\n\n-   explanatory variable → *might affect* → response variable\n:::\n::::\n\n## Conclusions\n\n::: incremental\n1.  Data should be initially assessed to determine the types of variables\n\n2.  Variables and descriptions are **metadata** (essential)\n\n3.  Hypothesized associations between the **predictor variable** and the **response variable** can be **positive**, **negative**, or **independent**\n:::\n\n# Study design\n\n## Study design\n\n::: incremental\n-   Understanding data provenance, including who or what the data represent, is crucial for making comprehensive conclusions.\n\n-   Sampling is a key aspect of data provenance; knowing how observational units were selected helps generalize findings to the larger population.\n\n-   Understanding the structure of the study helps distinguish between causal relationships and mere associations.\n\n-   Before analyzing data, it's important to ask, \"How were these observations collected?\" to gain insights about the data's source and quality.\n:::\n\n# Sampling principles\n\n## Populations and samples {.smaller}\n\n#### Consider the following:\n\n::: incremental\n1.  What is the average mercury content in swordfish in the Atlantic Ocean?\n\n2.  Over the last five years, what is the average time to complete a degree for Duke undergrads?\n\n3.  Does a new drug reduce the number of deaths in patients with severe heart disease?\n:::\n\n::: fragment\n#### What does each question have?\n:::\n\n:::: fragment\n::: incremental\n1.  Each refers to a target **population**\n2.  Likely not feasible to collect a **census** of the population\n3.  We then collect a **sample**\n:::\n::::\n\n## Parameters and statistics\n\n::: incremental\n-   Numerical summaries are calculated in each **sample** or for the entire **population**\n\n-   **Sample** level is a **statistic**\n\n-   **Population** level is a **parameter**\n:::\n\n## Anecdotal evidence {.smaller}\n\n#### Consider the following:\n\n::: incremental\n1.  A man on the news got mercury poisoning from eating swordfish, so the average mercury concentration in swordfish must be dangerously high.\n\n2.  I met two students who took more than 7 years to graduate from UArizona, so it must take longer to graduate at UArizona than at many other colleges.\n\n3.  My friend's dad had a heart attack and died after they gave him a new heart disease drug, so the drug must not work.\n:::\n\n::: fragment\n> This is **anecdotal evidence**\n:::\n\n## Sampling from a population {.smaller}\n\n![](images/pop-to-sample-1.png){fig-align=\"center\" width=\"3000\"}\n\n::: fragment\nHere we randomly sample 10 graduates from the population\n:::\n\n## Sampling from a population {.smaller}\n\n![](images/pop-to-sub-sample-graduates-1.png){fig-align=\"center\" width=\"3000\"}\n\n::: fragment\nBut... a nutrition major might disproportionately pick health-related majors.\n:::\n\n## Simple random sampling {.smaller}\n\n![](images/pop-to-sample-1.png){fig-align=\"center\" width=\"3000\"}\n\n::: fragment\n> Equivalent to drawing nmes from a hat\n:::\n\n## Non-response bias {.smaller}\n\n![](images/survey-sample-1.png){fig-align=\"center\" width=\"3000\"}\n\n::: fragment\n> Also beware of the convenience sample\n:::\n\n## Stratified sampling\n\n![](images/simple-stratified-1.png){fig-align=\"center\" width=\"2427\"}\n\n## Cluster + multistage sampling\n\n![](images/cluster-multistage-1.png){fig-align=\"center\" width=\"2427\"}\n\n## Lastly: correlation $\\neq$ causation!\n\n```{=html}\n<iframe width=\"1000\" height=\"400\" src=\"https://tylervigen.com/spurious-correlations\" frameborder=\"1\" style=\"background:white;\"></iframe\n```\n\n<br>\n\n## Conclusions\n\n::: incremental\n-   Conclusions from data mining need to be rigorously tested\n\n-   Sampling exists when we cannot collect a population\n\n-   Sampling methods help control bias\n\n-   Correlation does not equal causation!\n:::\n\n",
    "supporting": [
      "02-data_files/figure-revealjs"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}